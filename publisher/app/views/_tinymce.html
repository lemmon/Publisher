<script src="{{ link.vendor('tinymce/tinymce.min.js') }}"></script>
<script src="{{ link.vendor('tinymce/jquery.tinymce.min.js') }}"></script>
<script>
$(function(){
    $('article.edit').each(function(){
        var $article = $(this);
        // parse blocks
        $article.children('div').each(function(){
            $(this).nextUntil('div').wrapAll('<div class="html">');
        });
        $article.children(':first').filter(':not(div)').nextUntil('div').andSelf().wrapAll('<div class="html">');
        // add empty html to end if necessary
        if ($article.children('.html').size() == 0 || $article.children(':last').hasClass('html') == false) {
            $article.append('<div class="html">');
        }
        // tinymce
        $article.children('.html').tinymce({
            inline: true,
            hidden_input: false,
            menubar: false,
            height: 480,
            toolbar1: 'undo redo | formatselect | blockquote | visualblocks',
            toolbar2: 'bold italic | link | bullist numlist outdent indent',
            plugins: 'link, visualblocks',
            block_formats: 'Paragraph=p;Header 1=h1;Header 2=h2;Header 3=h3;Header 4=h4;Header 5=h5',
            valid_elements : 'p,strong/b,em/i,br,h1,h2,h3,h4,h5,ul,ol,li,blockquote,dl,dt,dd,a[href|target]'
                /*
                + ',div[class]'
                */
                + ',img[src|width|height|class<left?right]'
                + ',iframe[width|height|src|frameborder:0|allowfullscreen]'
        });
        
    })
});
</script>
